a:11:{s:4:"name";s:9:"csb_piwik";s:6:"status";s:1:"1";s:6:"author";s:18:"Christian Sandberg";s:10:"author_uri";s:20:"http://csandberg.se/";s:7:"version";s:3:"0.3";s:11:"description";s:34:"Generate JavaScript code for Piwik";s:4:"help";s:389:"	<h1>Installation</h1>

	<p>Put this right before &lt;/body&gt;:</p>

	<p>&lt;txp:csb_piwik url=&#8220;http://yoursite.com/piwik/&#8221; idsite=&#8220;1&#8221; /&gt;;</p>

	<h1>Parameters</h1>

	<ul>
		<li><strong>url</strong>: The <span class="caps">URL</span> to your Piwik installation (remember to end with /)</li>
		<li><strong>idsite</strong>: ID of the site (default: 1)</li>
	</ul>";s:4:"code";s:2513:"
/* Code is borrowed from rss_article_edit */

if (@txpinterface == 'admin') {
    add_privs('piwik','1,2,3,4,5,6');
  register_tab("extensions", "piwik", "piwik");
  register_callback("csb_admin_piwik", "piwik");
}

function csb_admin_piwik($event, $step) {
    global $piwik_cookie;
    include(txpath . '/include/txp_prefs.php');

    if (!isset($piwik_cookie)) {
        $piwik_cookie = "piwik";
        $rs = safe_insert('txp_prefs', "name='piwik_cookie', val='$piwik_cookie', prefs_id='1'");
    }

    if (gps("add")) {
        safe_update("txp_prefs", "val = 'piwik'","name = 'piwik_cookie' and prefs_id ='1'");
    setcookie($piwik_cookie, $piwik_cookie, time()+31536000, "/");
        header("Location: index.php?event=piwik");
  } else if (gps("rem")) {
        safe_update("txp_prefs", "val = '".addslashes(ps('piwik_cookie'))."'","name = 'piwik_cookie' and prefs_id ='1'");
      setcookie($piwik_cookie, $piwik_cookie, time()-3600, "/");
        header("Location: index.php?event=piwik");
  }

  pagetop("Piwik");

    $piwikcount = isset($_COOKIE[$piwik_cookie]) ? " not" : "";
    $piwik_input = isset($_COOKIE[$piwik_cookie]) ? fInput("submit","rem",gTxt("Log my visits"),"publish") : fInput("submit","add",gTxt("Stop logging my visits"),"publish");

  $tdaStyle = ' style="text-align:right;vertical-align:middle"';
  echo form(startTable("list").
  tr(tdcs(hed("Turn Piwik logging on/off for you",1),2)).
  tr(
      tda(graf('Your pageviews will'.$piwikcount.' be logged.', ' align="center"'), ' colspan="2"')
  ).
  tr(
      tda(graf($piwik_input.eInput("piwik"), ' align="center"'), ' colspan="2"')
  ).
  endTable());

}



function csb_piwik($atts, $thing='') {
	extract(lAtts(array(
		'url' => site_url(array()).'piwik/',
		'idsite' => '1',
	),$atts));

	if (!isset($_COOKIE['piwik'])) {
		return '<!-- Piwik -->
		<script type="text/javascript">
		var pkBaseURL = (("https:" == document.location.protocol) ? "'.str_replace('http://','https://', $url).'" : "'.$url.'");
		document.write(unescape("%3Cscript src=\'" + pkBaseURL + "piwik.js\' type=\'text/javascript\'%3E%3C/script%3E"));
		</script>
		<script type="text/javascript">
		try {
		var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", '.$idsite.');
		piwikTracker.trackPageView();
		piwikTracker.enableLinkTracking();
		} catch( err ) {}

		</script>
		<object><noscript><p>Web analytics <img src="'.$url.'piwik.php?idsite='.$idsite.'" style="border:0" alt="" /></p></noscript></object>
		<!-- End Piwik Tag -->	';
	}
}
";s:12:"code_restore";s:2513:"
/* Code is borrowed from rss_article_edit */

if (@txpinterface == 'admin') {
    add_privs('piwik','1,2,3,4,5,6');
  register_tab("extensions", "piwik", "piwik");
  register_callback("csb_admin_piwik", "piwik");
}

function csb_admin_piwik($event, $step) {
    global $piwik_cookie;
    include(txpath . '/include/txp_prefs.php');

    if (!isset($piwik_cookie)) {
        $piwik_cookie = "piwik";
        $rs = safe_insert('txp_prefs', "name='piwik_cookie', val='$piwik_cookie', prefs_id='1'");
    }

    if (gps("add")) {
        safe_update("txp_prefs", "val = 'piwik'","name = 'piwik_cookie' and prefs_id ='1'");
    setcookie($piwik_cookie, $piwik_cookie, time()+31536000, "/");
        header("Location: index.php?event=piwik");
  } else if (gps("rem")) {
        safe_update("txp_prefs", "val = '".addslashes(ps('piwik_cookie'))."'","name = 'piwik_cookie' and prefs_id ='1'");
      setcookie($piwik_cookie, $piwik_cookie, time()-3600, "/");
        header("Location: index.php?event=piwik");
  }

  pagetop("Piwik");

    $piwikcount = isset($_COOKIE[$piwik_cookie]) ? " not" : "";
    $piwik_input = isset($_COOKIE[$piwik_cookie]) ? fInput("submit","rem",gTxt("Log my visits"),"publish") : fInput("submit","add",gTxt("Stop logging my visits"),"publish");

  $tdaStyle = ' style="text-align:right;vertical-align:middle"';
  echo form(startTable("list").
  tr(tdcs(hed("Turn Piwik logging on/off for you",1),2)).
  tr(
      tda(graf('Your pageviews will'.$piwikcount.' be logged.', ' align="center"'), ' colspan="2"')
  ).
  tr(
      tda(graf($piwik_input.eInput("piwik"), ' align="center"'), ' colspan="2"')
  ).
  endTable());

}



function csb_piwik($atts, $thing='') {
	extract(lAtts(array(
		'url' => site_url(array()).'piwik/',
		'idsite' => '1',
	),$atts));

	if (!isset($_COOKIE['piwik'])) {
		return '<!-- Piwik -->
		<script type="text/javascript">
		var pkBaseURL = (("https:" == document.location.protocol) ? "'.str_replace('http://','https://', $url).'" : "'.$url.'");
		document.write(unescape("%3Cscript src=\'" + pkBaseURL + "piwik.js\' type=\'text/javascript\'%3E%3C/script%3E"));
		</script>
		<script type="text/javascript">
		try {
		var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", '.$idsite.');
		piwikTracker.trackPageView();
		piwikTracker.enableLinkTracking();
		} catch( err ) {}

		</script>
		<object><noscript><p>Web analytics <img src="'.$url.'piwik.php?idsite='.$idsite.'" style="border:0" alt="" /></p></noscript></object>
		<!-- End Piwik Tag -->	';
	}
}
";s:8:"code_md5";s:32:"a9458b23c45b6c87822b41d9257cf5a3";s:4:"type";s:1:"1";}